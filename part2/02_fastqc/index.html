
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../01_salmon_idx/">
      
      
        <link rel="next" href="../03_quant/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>2.2 Samplesheets, operators, and groovy - Nextflow for the Life Sciences</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-TNWWV3HK57"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-TNWWV3HK57",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-TNWWV3HK57",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#22-samplesheets-operators-and-groovy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nextflow for the Life Sciences" class="md-header__button md-logo" aria-label="Nextflow for the Life Sciences" data-md-component="logo">
      
  <img src="../../assets/usyd-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nextflow for the Life Sciences
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2.2 Samplesheets, operators, and groovy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Sydney-Informatics-Hub/hello-nextflow-2025" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Sydney-Informatics-Hub/hello-nextflow-2025
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nextflow for the Life Sciences" class="md-nav__button md-logo" aria-label="Nextflow for the Life Sciences" data-md-component="logo">
      
  <img src="../../assets/usyd-logo.png" alt="logo">

    </a>
    Nextflow for the Life Sciences
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Sydney-Informatics-Hub/hello-nextflow-2025" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Sydney-Informatics-Hub/hello-nextflow-2025
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Part 1
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Part 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/00_whynextflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.0 Why Nextflow?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/01_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.1 Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/02_helloworld/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.2 Hello World!
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/03_hellonf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.3 Writing your first pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/04_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.4 Running pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/05_inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.5 Inputs and channels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/06_params/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.6 Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/07_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.7 Adding processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/08_dynamic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.8 Dynamic naming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/09_outro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.9 Wrapping up
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Part 2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Part 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.0 Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_salmon_idx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.1 Our first process and container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    2.2 Samplesheets, operators, and groovy
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    2.2 Samplesheets, operators, and groovy
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#221-inspecting-our-fastqc-script" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.1 Inspecting our FastQC script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#222-building-the-fastqc-process" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.2 Building the FASTQC process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2.2 Building the FASTQC process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-the-process-directives" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the process directives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-the-process-output" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the process output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-the-process-input" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the process input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#223-reading-files-with-a-samplesheet" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.3 Reading files with a samplesheet
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_quant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.3 Multiple process inputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_multiqc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.4 Combining channels, multiple process outputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_scale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.5 Upscaling to multiple samples and introspection
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supporting materials
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#221-inspecting-our-fastqc-script" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.1 Inspecting our FastQC script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#222-building-the-fastqc-process" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.2 Building the FASTQC process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2.2 Building the FASTQC process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-the-process-directives" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the process directives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-the-process-output" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the process output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-the-process-input" class="md-nav__link">
    <span class="md-ellipsis">
      Defining the process input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#223-reading-files-with-a-samplesheet" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.3 Reading files with a samplesheet
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="22-samplesheets-operators-and-groovy">2.2 Samplesheets, operators, and groovy</h1>
<div class="admonition note">
<p class="admonition-title">Learning objectives</p>
<ol>
<li>Construct a Nextflow process that accepts a tuple input from a channel.</li>
<li>Describe the benefits of using a samplesheet to manage and read in workflow inputs.</li>
<li>Build a custom input channel using Groovy expressions and Nextflow operators. </li>
</ol>
</div>
<p>In this lesson we will transform the next bash script, <code>01_fastqc.sh</code> into a process called <code>FASTQC</code>. This step focuses on the next phase of RNAseq data processing: assessing the quality of some our raw sequencing reads. </p>
<p>To do this, we will need to run <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a> 
over pairs of FASTQ files. </p>
<p><img alt="" src="../img/2.2_workflow.png" /></p>
<p>Our goal in porting these bash scripts to Nextflow is to build a workflow that can scale to run on multiple samples with minimal intervention. To do this, we will use a samplesheet, allowing us to provide multiple samples and their corresponding FASTQ files to our Nextflow workflow. </p>
<p>Building channels in Nextflow can be tricky. Depending on what data you need 
to capture and how you want to organise it you will likely need to use 
<a href="https://www.nextflow.io/docs/latest/operator.html#operators">operators</a> to
manipulate your channel. We saw some simple operators back in Part 1.
However, sometimes operators alone won't be enough, and you'll
need to also use <a href="https://groovy-lang.org/documentation.html">Groovy</a>
(Nextflow's underlying programming language) to capture pertinent information.  </p>
<p>Since this is an advanced task, we will provide you with all the code you need. Although Nextflow does not yet offer a built-in operator for reading samplesheets, their use is widespread in bioinformatics workflows. So, we will be building a simple samplesheet reader from a couple of operators and some simple Groovy code.</p>
<h2 id="221-inspecting-our-fastqc-script">2.2.1 Inspecting our FastQC script</h2>
<p>Open the bash script <code>01_fastqc.sh</code>:  </p>
<div class="highlight"><span class="filename">01_fastqc.sh</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nv">SAMPLE_ID</span><span class="o">=</span>gut
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nv">READS_1</span><span class="o">=</span><span class="s2">&quot;data/ggal/</span><span class="si">${</span><span class="nv">SAMPLE_ID</span><span class="si">}</span><span class="s2">_1.fq&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nv">READS_2</span><span class="o">=</span><span class="s2">&quot;data/ggal/</span><span class="si">${</span><span class="nv">SAMPLE_ID</span><span class="si">}</span><span class="s2">_2.fq&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;results/fastqc_</span><span class="si">${</span><span class="nv">SAMPLE_ID</span><span class="si">}</span><span class="s2">_logs&quot;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>fastqc<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span>--outdir<span class="w"> </span><span class="s2">&quot;results/fastqc_</span><span class="si">${</span><span class="nv">SAMPLE_ID</span><span class="si">}</span><span class="s2">_logs&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span>--format<span class="w"> </span>fastq<span class="w"> </span><span class="si">${</span><span class="nv">READS_1</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">READS_2</span><span class="si">}</span>
</code></pre></div>
<p>There's a lot going on in this script, let's break it down.</p>
<p><code>SAMPLE_ID=gut</code> assigns "gut" to the bash variable<code>SAMPLE_ID</code>. This is used to:  </p>
<ul>
<li>Avoid hardcoding the sample name multiple times in the script  </li>
<li>Ensure that file pairs of the same sample are processed together (e.g. <code>gut_1.fq</code> and <code>gut_2.fq</code>)  </li>
<li>Ensure that this script can be run on different sample pairs  </li>
</ul>
<p><code>READS_1</code> and <code>READS_2</code> specify the paths to the paired gut <code>.fq</code> files.  </p>
<p>Similar to the bash script in the previous step (<code>00_index.sh</code>), <code>mkdir -p</code>
creates an output folder so that the <code>fastqc</code> outputs can be saved here.  </p>
<p>In the <code>fastqc</code> command,</p>
<ul>
<li><code>--outdir</code> specifies the name of the output directory</li>
<li><code>--format</code> is a required flag to indicate what format the the reads are in</li>
<li><code>${READS_1}</code> and <code>${READS_2}</code> propagate the paths of the <code>.fq</code> files  </li>
</ul>
<h2 id="222-building-the-fastqc-process">2.2.2 Building the <code>FASTQC</code> process</h2>
<h3 id="defining-the-process-directives">Defining the process directives</h3>
<p>Start by adding the following <code>process</code> scaffold and script definition to your
<code>main.nf</code> under the INDEX process code but before the <code>workflow{}</code> block:  </p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">process</span><span class="w"> </span><span class="n">FASTQC</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="n">container</span><span class="w"> </span><span class="s2">&quot;quay.io/biocontainers/fastqc:0.12.1--hdfd78af_0&quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="n">publishDir</span><span class="w"> </span><span class="s2">&quot;results&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">mode:</span><span class="w"> </span><span class="s1">&#39;copy&#39;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="nl">input:</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="o">&lt;</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="o">&gt;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span><span class="nl">output:</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span><span class="o">&lt;</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="o">&gt;</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">  </span><span class="nl">script:</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="s2">  mkdir -p &quot;fastqc_${sample_id}_logs&quot;</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="s2">  fastqc --outdir &quot;fastqc_${sample_id}_logs&quot; --format fastq $reads_1 $reads_2</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="s2">  &quot;&quot;&quot;</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="o">}</span>
</code></pre></div>
<p>It contains: </p>
<ul>
<li>Prefilled process directives <code>container</code> and <code>publishDir</code>.</li>
<li>The empty <code>input:</code> block for us to define the input data for the process. </li>
<li>The empty <code>output:</code> block for us to define the output data for the process.</li>
<li>The <code>script:</code> block prefilled with the command that will be executed.</li>
</ul>
<p>Note that for the script block we have removed the initial three lines that contained the bash variable definitions. Instead, we will be using Nextflow variables that are defined within the process' <code>input</code> block.</p>
<p>However, note that the <code>mkdir</code> and <code>fastqc</code> commands that remain look very similar to their original forms, but are now using those Nextflow variables instead of the original bash variables.</p>
<div class="admonition info">
<p class="admonition-title">Dynamic naming</p>
<p>Recall that curly brackets are used to pass variables as part of a file name.</p>
</div>
<details class="example">
<summary>Advanced content: Nextflow vs Bash variables</summary>
<p>If you are familiar with Bash programming, you may notice that the way we use Nextflow variables looks exactly like how we use Bash variables - by using the <code>$</code> symbol followed by the variable name, possibly within curly brackets:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nl">script:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="s2">mkdir -p &quot;fastqc_${sample_id}_logs&quot;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<p>This actually means that Bash variables can't be used in the same way as they normally are. Instead, if you ever need to use a Bash variable within a Nextflow process, you will first need to <strong>escape</strong> the <code>$</code> symbol with a backslash (<code>\</code>). This tells Nextflow to ignore the <code>$</code> and not interpret it as a Nextflow variable:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nl">script:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="s2">SOMEBASHVAR=&quot;hello&quot;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="s2">echo \${SOMEBASHVAR}</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<p>For the purposes of this workshop, we won't be using Bash variables, so you don't need to worry about this quirk for now.</p>
</details>
<h3 id="defining-the-process-output">Defining the process <code>output</code></h3>
<p>Unlike <code>salmon</code> from the previous process, <code>fastqc</code> requires that the output
directory be created before running the command, hence the requirement to run
<code>mkdir -p "fastqc_${sample_id}_logs"</code> within the <code>script</code> block. This is a common 
inconsistency between different bioinformatics tools, so it is good to be aware of it.</p>
<p>Looking at the FastQC command we can see this directory will be our output.  </p>
<div class="admonition question">
<p class="admonition-title">Exercise</p>
<p>Replace <code>&lt; process outputs &gt;</code> with the appropriate output definition for
the <code>FASTQC</code> process.  </p>
<details class="note">
<summary>Solution</summary>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nl">output:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="hll"><span class="n">path</span><span class="w"> </span><span class="s2">&quot;fastqc_${sample_id}_logs&quot;</span>
</span></code></pre></div>
<p>We've used the <code>path</code> qualifier because our output is a directory.
Output from the bash script is defined by the fastqc <code>--outdir</code> flag.
Because our output contains constant text (i.e. <code>"fastqc_"</code> and <code>"_logs"</code>),
we put the whole output string in double quotes and use the dollar sign and curly braces
to access the <code>sample_id</code> variable.</p>
</details>
</div>
<h3 id="defining-the-process-input">Defining the process <code>input</code></h3>
<p>Now we need to define the <code>input</code> block for this process. In this process, 
we're going to use a combination of Nextflow operators and Groovy to do this. </p>
<p>There are three inputs
for this process definition that can be taken from the script definition you
just added:</p>
<ol>
<li><code>$sample_id</code></li>
<li><code>$reads_1</code></li>
<li><code>$reads_2</code></li>
</ol>
<p>In order to ensure we process the sample ID along with its two related FASTQ files together, we will introduce a new input qualifier: the <a href="https://www.nextflow.io/docs/latest/process.html#input-tuples-tuple"><code>tuple</code></a>.</p>
<p>A tuple is simply an ordered collection of objects. When you use a tuple as input to a Nextflow process, it ensures that the objects inside are grouped and processed together as a single unit. This is a requirement when working with multiple pieces of data that are specific to a given sample.</p>
<div class="admonition info">
<p class="admonition-title">Importance of proper data grouping when using Nextflow</p>
<p>Nextflow uses channels to run processes in parallel and if you aren't
careful about how you handle multiple pieces of related data that need to be tied
together (e.g. sample IDs and FASTQ paths), you may mix datasets up.</p>
<p>We can use the <a href="https://www.nextflow.io/docs/latest/process.html#inputs">input qualifier</a>
<code>tuple</code> to group multiple values into a single input definition.</p>
</div>
<p>In our case, we have three related pieces of data: a <code>$sample_id</code> and its two FASTQ read files <code>$reads_1</code> 
and <code>$reads_2</code>. We will define a tuple input to ensure that these inputs stay linked and are processed together,
preventing our sample IDs and FASTQ files from getting mixed up between samples.</p>
<p><img alt="" src="../img/2.2_tuple.png" /></p>
<p>In the <code>FASTQC</code> process, replace <code>&lt; process inputs &gt;</code> with the input tuple definition:  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>tuple val(sample_id), path(reads_1), path(reads_2)
</code></pre></div>
<p>Our tuple contains three elements:</p>
<ul>
<li><code>val(sample_id)</code> represents the <strong>value</strong> that refers to the sample name.</li>
<li><code>path(reads_1)</code> represents the <strong>path</strong> to the first read file of paired-end sequencing data.</li>
<li><code>path(reads_2)</code> represents the <strong>path</strong> to the second read file of paired-end sequencing data.</li>
</ul>
<p>Note how each item within the tuple has its own qualifier. Also note how we must now wrap each item's name within parentheses, and separte them by commas.</p>
<p>Our <code>FASTQC</code> process should now look like this:</p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">process</span><span class="w"> </span><span class="n">FASTQC</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="n">container</span><span class="w"> </span><span class="s2">&quot;quay.io/biocontainers/fastqc:0.12.1--hdfd78af_0&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="n">publishDir</span><span class="w"> </span><span class="s2">&quot;results&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">mode:</span><span class="w"> </span><span class="s1">&#39;copy&#39;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="nl">input:</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="hll"><span class="w">  </span><span class="n">tuple</span><span class="w"> </span><span class="n">val</span><span class="o">(</span><span class="n">sample_id</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">reads_1</span><span class="o">),</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">reads_2</span><span class="o">)</span>
</span><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">  </span><span class="nl">output:</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s2">&quot;fastqc_${sample_id}_logs&quot;</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span><span class="nl">script:</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="s2">  mkdir -p &quot;fastqc_${sample_id}_logs&quot;</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="s2">  fastqc --outdir &quot;fastqc_${sample_id}_logs&quot; --format fastq $reads_1 $reads_2</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="s2">  &quot;&quot;&quot;</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="o">}</span>
</code></pre></div>
<h2 id="223-reading-files-with-a-samplesheet">2.2.3 Reading files with a samplesheet</h2>
<p>Up until this point in the workshop, we have been using a lot of hard-coded values.</p>
<p>In practice, hard-coded values, particularly for file names and sample IDs, should almost never be used. Instead, we need a flexible way of providing variable values to our pipeline. For that purpose, we can use a samplesheet.</p>
<p>A samplesheet is a delimited text file where each row contains information
or metadata that needs to be processed together.</p>
<p><img alt="" src="../img/2.2_samplesheet.png" /></p>
<details class="tip">
<summary>Tip: using samplesheets in scalable bioinformatics workflows</summary>
<p>Working with samplesheets is particularly useful when you have a combination of files and metadata that need to be assigned to a sample in a flexible manner. Typically, samplesheets are written in comma-separated (<code>.csv</code>) or tab-separated (<code>.tsv</code>) formats. </p>
<p>We recommend using comma-separated files as they are less error prone and easier to read and write.</p>
</details>
<p>Let's inspect <code>data/samplesheet.csv</code> with VSCode.</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="go">sample,fastq_1,fastq_2</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="go">gut,data/ggal/gut_1.fq,data/ggal/gut_2.fq</span>
</code></pre></div>
<p>Think of this file like a table; each line is a row and within each row are multiple 'columns' delimited by comma symbols (<code>,</code>). This samplesheet has two rows. The first is a header row; the values here will be used as names for each of the columns. The second row is a single sample, <code>gut</code>. At this stage, we are developing and testing the pipeline, so, we're only working with one sample. The samplesheet has three columns:  </p>
<ul>
<li><code>sample</code>: indicates the sample name/prefix (in this case: <code>gut</code>)</li>
<li><code>fastq_1</code>, <code>fastq_2</code>: contains the relative paths to the paired read FASTQ files (in this case: <code>data/ggal/gut_1.fq</code> and <code>data/ggal/gut_2.fq</code>)</li>
</ul>
<p><img alt="" src="../img/2.2_samplesheet_table.png" /></p>
<p>The goal in this step is to read the contents of the samplesheet, and transform
it so it fits the input definition of <code>FASTQC</code> we just defined:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>tuple<span class="w"> </span>val<span class="o">(</span>sample_id<span class="o">)</span>,<span class="w"> </span>path<span class="o">(</span>reads_1<span class="o">)</span>,<span class="w"> </span>path<span class="o">(</span>reads_2<span class="o">)</span>
</code></pre></div>
<p>Before that, we need to add an input parameter that points to the samplesheet, called <code>reads</code>.  </p>
<div class="admonition question">
<p class="admonition-title">Exercise</p>
<p>In your <code>main.nf</code> add a new input parameter called <code>reads</code> and assign it a default path
to the samplesheet, using the <code>$projectDir</code> variable as before.</p>
<details class="note">
<summary>Solution</summary>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// pipeline input parameters</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;$projectDir/data/ggal/transcriptome.fa&quot;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="hll"><span class="n">params</span><span class="o">.</span><span class="na">reads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;$projectDir/data/samplesheet.csv&quot;</span>
</span></code></pre></div>
</details>
</div>
<p>In the next few steps, we will add a mix of <a href="https://www.nextflow.io/docs/latest/operator.html">Nextflow operators</a> and Groovy
syntax to read in and parse the samplesheet so it is in the correct format
for the process we just added.  </p>
<div class="admonition info">
<p class="admonition-title">Using samplesheets with Nextflow can be tricky business</p>
<p>There are currently no Nextflow operators specifically designed to handle samplesheets. As such, we Nextflow workflow developers have to write custom parsing logic to read and split the data. This adds complexity to our workflow development, especially when trying to handle tasks like parallel processing of samples or filtering data by sample type.</p>
</div>
<p>Add the following to your workflow scope below where <code>INDEX</code> is called:</p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">// Define the workflow  </span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="c1">// Run the index step with the transcriptome parameter</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="n">INDEX</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="o">)</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="hll"><span class="w">    </span><span class="c1">// Define the fastqc input channel</span>
</span><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="hll"><span class="w">    </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">reads</span><span class="o">)</span>
</span><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="hll"><span class="w">        </span><span class="o">.</span><span class="na">splitCsv</span><span class="o">(</span><span class="nl">header:</span><span class="w"> </span><span class="kc">true</span><span class="o">)</span>
</span><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="hll"><span class="w">        </span><span class="o">.</span><span class="na">map</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">row</span><span class="o">.</span><span class="na">sample</span><span class="o">,</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_1</span><span class="o">),</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_2</span><span class="o">)]</span><span class="w"> </span><span class="o">}</span>
</span><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="hll"><span class="w">        </span><span class="o">.</span><span class="na">view</span><span class="o">()</span>
</span><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="hll">
</span><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="o">}</span>
</code></pre></div>
<p>This looks a bit complicated, but the essential idea is that we read in our samplesheet file with the <a href="https://www.nextflow.io/docs/latest/reference/channel.html#frompath"><code>.fromPath</code></a> channel factory and the <a href="https://www.nextflow.io/docs/latest/reference/operator.html#splitcsv"><code>.splitCSV</code></a> operator and <strong>transform</strong> the data into our final <code>tuple</code> format with the <a href="https://www.nextflow.io/docs/latest/reference/operator.html#map"><code>.map</code></a> operator. The key takeaway here is to understand that using samplesheets is best practice for reading grouped files and metadata into Nextflow, and that both Nextflow operators and Groovy code need to be chained together to get these in the correct format.</p>
<details class="example">
<summary>Advanced content: A deeper look at the samplesheet logic</summary>
<p>Our samplesheet input channel has used a few common Nextflow operators chained together:</p>
<ul>
<li><a href="https://www.nextflow.io/docs/latest/reference/channel.html#frompath"><code>.fromPath</code></a> is a channel factory that creates a channel from one or more files matching a given path or pattern. In this case, this is our samplesheet <code>.csv</code> file contained in the <code>params.reads</code> parameter, provided with the <code>--reads</code> command line flag.</li>
<li><a href="https://www.nextflow.io/docs/latest/reference/operator.html#splitcsv"><code>.splitCsv</code></a> splits the input file into rows, treating it as a CSV (Comma-Separated Values) file. The <code>header: true</code> option means that the first row of the CSV contains column headers, which will be used to access the values by name.</li>
<li><code>.map { row -&gt; [row.sample, file(row.fastq_1), file(row.fastq_2)] }</code> uses the <a href="https://www.nextflow.io/docs/latest/reference/operator.html#map"><code>.map</code></a> operator and some Groovy syntax to transform each row of the CSV file into a tuple, extracting the <code>sample</code> value, as well as the <code>fastq_1</code> and <code>fastq_2</code> file paths from the row.</li>
<li><a href="https://www.nextflow.io/docs/latest/operator.html#view"><code>.view()</code></a> is a debugging step that outputs the transformed data to the console so we can see how the channel is structured. It's a great tool to use when building your channels.</li>
</ul>
</details>
<details class="tip">
<summary>Tip: using the <code>view()</code> operator for testing</summary>
<p>The <a href="https://www.nextflow.io/docs/latest/operator.html#view"><code>view()</code></a> operator is a useful tool for debugging Nextflow workflows. It allows you to inspect the data structure of a channel at any point in the workflow, helping you to understand how the data is being processed and transformed.</p>
</details>
<p>Run the workflow with the <code>-resume</code> flag:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>nextflow<span class="w"> </span>run<span class="w"> </span>main.nf<span class="w"> </span>-resume
</code></pre></div>
<p>Your output should look something like:  </p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="go">Launching `main.nf` [crazy_einstein] DSL2 - revision: 0ae3776a5e</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="go">[de/fef8c4] INDEX [100%] 1 of 1, cached: 1 ✔</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="go">[gut, /home/setup2/hello-nextflow/part2/data/ggal/gut_1.fq, /home/setup2/hello-nextflow/part2/data/ggal/gut_2.fq]</span>
</code></pre></div>
<details class="tip">
<summary>Tip: using the <code>-resume</code> flag</summary>
<p>The <code>-resume</code> flag is used to resume a Nextflow workflow from where it left off. If a workflow fails or is interrupted, this flag allows you to skip tasks that were successfully completed, saving time and computational resources. It is also useful when you are developing a workflow and want to test changes without running the entire workflow from the start. </p>
</details>
<p>The chain of commands produces a tuple with three elements that correspond to
the row in the samplesheet. It now fits the requirements of the input
definition of <code>tuple val(sample_id), path(reads_1), path(reads_2)</code>: </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="o">[</span>gut,<span class="w"> </span>/home/setup2/hello-nextflow/part2/data/ggal/gut_1.fq,<span class="w"> </span>/home/setup2/hello-nextflow/part2/data/ggal/gut_2.fq<span class="o">]</span>
</code></pre></div>
<div class="admonition quote">
<p class="admonition-title">How's it going?</p>
<p>Once you have run the workflow, select the  <strong>"Yes"</strong> react on Zoom.</p>
</div>
<p>Next, we need to assign the channel we create to a variable so it can be passed to the <code>FASTQC</code>
process. Assign to a variable called <code>reads_in</code>, and remove the <code>.view()</code>
operator as we now know what the output looks like.</p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">// Define the workflow  </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="c1">// Run the index step with the transcriptome parameter</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="n">INDEX</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="o">)</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="c1">// Define the fastqc input channel</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="hll"><span class="w">    </span><span class="n">reads_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">reads</span><span class="o">)</span>
</span><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">        </span><span class="o">.</span><span class="na">splitCsv</span><span class="o">(</span><span class="nl">header:</span><span class="w"> </span><span class="kc">true</span><span class="o">)</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">        </span><span class="o">.</span><span class="na">map</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">row</span><span class="o">.</span><span class="na">sample</span><span class="o">,</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_1</span><span class="o">),</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_2</span><span class="o">)]</span><span class="w"> </span><span class="o">}</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="hll">
</span><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="o">}</span>
</code></pre></div>
<p>Now that we have an input channel ready that provides the correct format,
we can call the <code>FASTQC</code> process.  </p>
<div class="admonition question">
<p class="admonition-title">Exercise</p>
<p>In the <code>workflow</code> scope after where <code>reads_in</code> was defined, call the
<code>FASTQC</code> process with <code>reads_in</code> as the input.</p>
<details class="note">
<summary>Solution</summary>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1">// Define the workflow  </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="c1">// Run the index step with the transcriptome parameter</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="n">INDEX</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="o">)</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="c1">// Define the fastqc input channel</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span><span class="n">reads_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">reads</span><span class="o">)</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">        </span><span class="o">.</span><span class="na">splitCsv</span><span class="o">(</span><span class="nl">header:</span><span class="w"> </span><span class="kc">true</span><span class="o">)</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">        </span><span class="o">.</span><span class="na">map</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">row</span><span class="o">.</span><span class="na">sample</span><span class="o">,</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_1</span><span class="o">),</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_2</span><span class="o">)]</span><span class="w"> </span><span class="o">}</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="hll"><span class="w">    </span><span class="c1">// Run the fastqc step with the reads_in channel</span>
</span><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="hll"><span class="w">    </span><span class="n">FASTQC</span><span class="o">(</span><span class="n">reads_in</span><span class="o">)</span><span class="w"> </span>
</span><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="o">}</span>
</code></pre></div>
</details>
</div>
<p>Run the workflow:  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>nextflow<span class="w"> </span>run<span class="w"> </span>main.nf<span class="w"> </span>-resume
</code></pre></div>
<p>Your output should look something like:  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>Launching `main.nf` [tiny_aryabhata] DSL2 - revision: 9a45f4957b
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>executor &gt;  local (1)
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>[de/fef8c4] INDEX      [100%] 1 of 1, cached: 1 ✔
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>[bb/32a3aa] FASTQC (1) [100%] 1 of 1 ✔
</code></pre></div>
<p>If you inspect <code>results/fastqc_gut_logs</code> there is an <code>.html</code> and <code>.zip</code> file
for each of the <code>.fastq</code> files.  </p>
<details class="example">
<summary>Advanced exercise: Inspecting our samplesheet reader</summary>
<p>This advanced exercise walks through inspecing the output of the intermediate
operators in the <code>reads_in</code> channel:  </p>
<ul>
<li><code>Channel.fromPath</code></li>
<li><code>.splitCsv</code></li>
</ul>
<p>The current workflow block should look like:</p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1">// Define the workflow  </span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span><span class="c1">// Run the index step with the transcriptome parameter</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="n">INDEX</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="o">)</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="c1">// Define the fastqc input channel</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="n">reads_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">reads</span><span class="o">)</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">        </span><span class="o">.</span><span class="na">splitCsv</span><span class="o">(</span><span class="nl">header:</span><span class="w"> </span><span class="kc">true</span><span class="o">)</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">        </span><span class="o">.</span><span class="na">map</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">row</span><span class="o">.</span><span class="na">sample</span><span class="o">,</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_1</span><span class="o">),</span><span class="w"> </span><span class="n">file</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">fastq_2</span><span class="o">)]</span><span class="w"> </span><span class="o">}</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">    </span><span class="c1">// Run the fastqc step with the reads_in channel</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">    </span><span class="n">FASTQC</span><span class="o">(</span><span class="n">reads_in</span><span class="o">)</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="o">}</span>
</code></pre></div>
<p><strong><code>Channel.fromPath</code></strong>  </p>
<ol>
<li>In the workflow scope, comment out the lines for <code>.splitCsv</code>, <code>.map</code>, and <code>FASTQC()</code></li>
<li>Add <code>.view()</code> on the line after <code>Channel.fromPath</code> and before the commented <code>.splitCsv</code></li>
<li>Run the workflow with <code>-resume</code>  </li>
</ol>
<details class="note">
<summary>Solution</summary>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1">// Define the workflow  </span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">    </span><span class="c1">// Run the index step with the transcriptome parameter</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">    </span><span class="n">INDEX</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="o">)</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">    </span><span class="c1">// Define the fastqc input channel</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">    </span><span class="n">reads_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">reads</span><span class="o">)</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="hll"><span class="w">        </span><span class="o">.</span><span class="na">view</span><span class="o">()</span>
</span><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="hll"><span class="w">        </span><span class="c1">//.splitCsv(header: true)</span>
</span><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="hll"><span class="w">        </span><span class="c1">//.map { row -&gt; [row.sample, file(row.fastq_1), file(row.fastq_2)] }</span>
</span><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">    </span><span class="c1">// Run the fastqc step with the reads_in channel</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="hll"><span class="w">    </span><span class="c1">//FASTQC(reads_in)</span>
</span><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="o">}</span>
</code></pre></div>
<p>The output of the <code>Channel.fromPath(params.reads)</code> step produces a path to the samplesheet:  </p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="go">Launching `main.nf` [hungry_lalande] DSL2 - revision: 587b5b70d1</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="go">[de/fef8c4] INDEX [100%] 1 of 1, cached: 1 ✔</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="go">/home/user1/part2/data/samplesheet.csv</span>
</code></pre></div>
</details>
<p><strong><code>.splitCsv</code></strong>  </p>
<ol>
<li>In the workflow scope, <em>un</em>comment the line for <code>.splitCsv</code></li>
<li>Move <code>.view()</code> to the line after <code>.splitCsv</code> (before the commented <code>.map</code> line)</li>
<li>Run the workflow with <code>-resume</code>  </li>
</ol>
<details class="note">
<summary>Solution</summary>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1">// Define the workflow  </span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="c1">// Run the index step with the transcriptome parameter</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">    </span><span class="n">INDEX</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="o">)</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">    </span><span class="c1">// Define the fastqc input channel</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">    </span><span class="n">reads_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Channel</span><span class="o">.</span><span class="na">fromPath</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">reads</span><span class="o">)</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="hll"><span class="w">        </span><span class="o">.</span><span class="na">splitCsv</span><span class="o">(</span><span class="nl">header:</span><span class="w"> </span><span class="kc">true</span><span class="o">)</span>
</span><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="hll"><span class="w">        </span><span class="o">.</span><span class="na">view</span><span class="o">()</span>
</span><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">        </span><span class="c1">//.map { row -&gt; [row.sample, file(row.fastq_1), file(row.fastq_2)] }</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">    </span><span class="c1">// Run the fastqc step with the reads_in channel</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">    </span><span class="c1">//FASTQC(reads_in)</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="o">}</span>
</code></pre></div>
<p><code>.splitCsv</code> takes the path from the <code>.fromPath</code> operator and reads the file. It outputs a queue channel with one element for each line of the CSV file.
Each element of this channel is similar to a tuple, except each value is associated with its corresponding column name from the header row of the CSV file:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="go">Launching `main.nf` [tiny_yonath] DSL2 - revision: 22c2c9d28f</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="go">[de/fef8c4] INDEX | 1 of 1, cached: 1 ✔</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="go">[sample:gut, fastq_1:data/ggal/gut_1.fq, fastq_2:data/ggal/gut_2.fq]</span>
</code></pre></div>
<p>This is called a key-value pair. Each of the values can be accessed by its key value (the column name). Our <code>.map</code> operator does exactly this (e.g. <code>row.sample</code> and <code>row.fastq_1</code>) and formats it into the final tuple that is stored as <code>reads_in</code> and passed to <code>FASTQC</code>.</p>
</details>
<p>Before proceeding, ensure to <em>un</em>comment the <code>.map</code> and <code>FASTQC</code> lines, and remove <code>.view()</code>.</p>
</details>
<div class="admonition abstract">
<p class="admonition-title">Summary</p>
<p>In this lesson you have learned:</p>
<ol>
<li>How to implement a process with a tuple input</li>
<li>How to construct an input channel using operators and Groovy</li>
<li>How to use the <code>.view()</code> operator to inspect the structure of a channel</li>
<li>How to use the <code>-resume</code> flag to skip sucessful tasks</li>
<li>How to use a samplesheet to read in grouped samples and metadata</li>
</ol>
</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../01_salmon_idx/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 2.1 Our first process and container">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                2.1 Our first process and container
              </div>
            </div>
          </a>
        
        
          
          <a href="../03_quant/" class="md-footer__link md-footer__link--next" aria-label="Next: 2.3 Multiple process inputs">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                2.3 Multiple process inputs
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>